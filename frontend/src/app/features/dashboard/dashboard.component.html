<div class="dashboard-container">
    <header class="dashboard-header">
        <div class="brand">
            <div class="logo-icon"></div>
            <h1>VoxVerify</h1>
        </div>
        <div class="user-actions">
            <!-- New Analysis Button (Actionable) -->
            <button class="btn btn-primary" (click)="navigateToAnalysis()">
                <span class="icon">+</span> New Analysis
            </button>
            <button class="btn btn-outline" (click)="logout()">Sign Out</button>
        </div>
    </header>

    <main class="dashboard-content">
        <section class="history-section card">
            <div class="section-header">
                <h2>Analysis History</h2>
                <div class="filter-controls">
                    <select [(ngModel)]="selectedLanguage" (change)="onFilterChange()">
                        <option *ngFor="let lang of languages" [value]="lang">{{ lang }}</option>
                    </select>
                </div>
            </div>

            <div class="table-container">
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Filename</th>
                            <th>Language</th>
                            <th>Result</th>
                            <th>Confidence</th>
                            <th>Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let item of history">
                            <td class="filename">{{ item.filename }}</td>
                            <td>{{ item.language || 'Unknown' }}</td>
                            <td>
                                <span class="badge" [class.human-badge]="item.classification === 'HUMAN'"
                                    [class.ai-badge]="item.classification !== 'HUMAN'">
                                    {{ item.classification === 'HUMAN' ? 'HUMAN' : 'AI GENERATED' }}
                                </span>
                            </td>
                            <td>{{ (item.confidence_score * 100) | number:'1.0-1' }}%</td>
                            <td class="date">{{ item.created_at | date:'mediumDate' }}</td>
                        </tr>
                        <tr *ngIf="history.length === 0 && !loading" class="empty-state">
                            <td colspan="5">
                                <div class="empty-content">
                                    <p>No analysis history found.</p>
                                    <button class="btn btn-primary btn-sm" (click)="navigateToAnalysis()">Start
                                        Analysis</button>
                                </div>
                            </td>
                        </tr>
                        <tr *ngIf="loading" class="loading-state">
                            <td colspan="5">
                                <div class="spinner-sm"></div> Loading...
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Pagination -->
            <div class="pagination-controls" *ngIf="totalPages > 1">
                <button class="btn-page" [disabled]="page === 1" (click)="prevPage()">Previous</button>
                <span class="page-info">Page {{ page }} of {{ totalPages }}</span>
                <button class="btn-page" [disabled]="page === totalPages" (click)="nextPage()">Next</button>
            </div>
        </section>
    </main>
</div>