services:
  # 1. DATABASE (PostgreSQL)
  - type: psql
    name: voxverify-db
    region: singapore
    plan: free

  # 2. BACKEND API (FastAPI)
  - type: web
    name: voxverify-api
    runtime: docker
    region: singapore
    plan: free
    branch: main
    rootDir: .
    dockerContext: .
    dockerfilePath: ./backend/Dockerfile
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: voxverify-db
          property: connectionString
      - key: JWT_SECRET
        generateValue: true
      - key: DEBUG
        value: "false"
